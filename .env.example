# =============================================================================
# INFRASTRUCTURE CREDENTIALS (REQUIRED IN PRODUCTION)
# =============================================================================

# Database Configuration (REQUIRED)
# PostgreSQL URL - Format: postgres://USER:PASSWORD@HOST:PORT/DBNAME
DATABASE_URL=
# DATABASE_SSL: 'true' para SSL, 'no-verify' para ignorar verificação de certificado, vazio/false para sem SSL
DATABASE_SSL=

# Redis Configuration (REQUIRED)
# Format: redis://default:PASSWORD@HOST:PORT or redis://HOST:PORT
REDIS_URL=

# Encryption & Security (REQUIRED)
# Master key for AES-GCM encryption (minimum 32 characters)
KMS_MASTER_KEY=

# Authentication Tokens (REQUIRED)
# Admin token for /admin endpoints (minimum 32 characters)
ADMIN_TOKEN=
# Webhook token for Evolution API callbacks (minimum 32 characters)
EVOLUTION_WEBHOOK_TOKEN=

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Server Configuration
PORT=3000
NODE_ENV=production
SERVER_URL=

# JWT Configuration (optional)
JWT_SECRET=

# =============================================================================
# WHATSAPP BUSINESS API CONFIGURATION
# =============================================================================

# WhatsApp Business API Credentials (REQUIRED)
WHATSAPP_ACCESS_TOKEN=your_whatsapp_access_token_here
WHATSAPP_APP_SECRET=your_whatsapp_app_secret_here
WHATSAPP_VERIFY_TOKEN=your_custom_verify_token_here
WHATSAPP_PHONE_NUMBER_ID=your_phone_number_id_here

# =============================================================================
# MARLIE AGENT CONFIGURATION
# =============================================================================

# Marlie Agent Settings
MARLIE_TEMPERATURE=0.2
MARLIE_MAX_TOKENS=400
MARLIE_BUFFER_WINDOW_SECONDS=30
MARLIE_SESSION_TIMEOUT_MINUTES=60

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# TENANT-SPECIFIC CONFIGURATIONS
# Note: These should be migrated to tenant_configs table in production
# Only use these for development/staging environments
# =============================================================================

# Evolution WhatsApp API (DEV/STAGING ONLY)
EVOLUTION_BASE_URL=
EVOLUTION_API_KEY=
EVOLUTION_INSTANCE=

# Trinks Integration (DEV/STAGING ONLY)
TRINKS_BASE_URL=
TRINKS_API_KEY=
TRINKS_ESTABELECIMENTO_ID=

# OpenAI Configuration (DEV/STAGING ONLY)
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4o-mini

# =============================================================================
# LEGACY SUPPORT (OPTIONAL)
# =============================================================================

# Legacy Database (optional)
LEGACY_DATABASE_URL=
LEGACY_DATABASE_SSL=

# =============================================================================
# LOGGING & MONITORING
# =============================================================================

# Log Level (debug, info, warn, error)
LOG_LEVEL=info

# Enable response logging in production (true/false)
LOG_RESPONSES=false

# Enable PII masking in logs (true/false)
MASK_PII=true

# =============================================================================
# RATE LIMITING & SECURITY
# =============================================================================

# Rate limiting windows (in seconds)
RATE_LIMIT_WINDOW_ADMIN=60
RATE_LIMIT_WINDOW_WEBHOOK=60
RATE_LIMIT_WINDOW_API=60

# Rate limiting max requests per window
RATE_LIMIT_MAX_ADMIN=60
RATE_LIMIT_MAX_WEBHOOK=60
RATE_LIMIT_MAX_API_IP=100
RATE_LIMIT_MAX_API_PHONE=30

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Cache TTLs (in seconds)
CACHE_TTL_CONFIG=300
CACHE_TTL_CONVERSATION=7200
CACHE_TTL_CATALOG=21600
CACHE_TTL_DEDUPE=900
CACHE_TTL_IDEMPOTENCY=1800

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================

# Health check timeouts (in milliseconds)
HEALTH_CHECK_TIMEOUT_DB=5000
HEALTH_CHECK_TIMEOUT_REDIS=3000
HEALTH_CHECK_TIMEOUT_EVOLUTION=10000
HEALTH_CHECK_TIMEOUT_TRINKS=10000

# =============================================================================
# DEVELOPMENT/TESTING ONLY
# =============================================================================

# Test database (for running tests)
TEST_DATABASE_URL=

# Enable debug mode (true/false)
DEBUG=false

# Skip authentication in development (true/false) - NEVER use in production
SKIP_AUTH=false

# Redis (opcional)
REDIS_URL=

# Admin/Auth
ADMIN_USER=
ADMIN_PASS=
JWT_SECRET=your_jwt_secret_key

# Logging Configuration
LOG_LEVEL=ERROR,WARN,DEBUG,INFO,LOG,VERBOSE,DARK,WEBHOOKS
LOG_COLOR=true
LOG_BAILEYS=error

# Database Configuration
# PostgreSQL URL (required)
# Format: postgres://USER:PASSWORD@HOST:PORT/DBNAME
DATABASE_URL=postgres://user:password@localhost:5432/syncbelle

# Redis Configuration (optional - for caching)
# Format: redis://default:PASSWORD@HOST:PORT
REDIS_URL=redis://localhost:6379
CACHE_REDIS_ENABLED=false
CACHE_REDIS_PREFIX_KEY=syncbelle
CACHE_REDIS_TTL=604800
CACHE_LOCAL_ENABLED=true
CACHE_LOCAL_TTL=604800

# Database SSL Configuration
# Set to 'true' for SSL (common in cloud providers), 'no-verify' to skip cert verification, or leave empty/false for no SSL
DATABASE_SSL=true

# Storage Configuration (Evolution API)
# Temporary storage settings
STORE_MESSAGES=true
STORE_MESSAGE_UP=true
STORE_CONTACTS=true
STORE_CHATS=true

# Persistent storage settings
DATABASE_ENABLED=true
DATABASE_SAVE_DATA_INSTANCE=true
DATABASE_SAVE_DATA_NEW_MESSAGE=true
DATABASE_SAVE_MESSAGE_UPDATE=true
DATABASE_SAVE_DATA_CONTACTS=true
DATABASE_SAVE_DATA_CHATS=true

# Cleanup settings
CLEAN_STORE_CLEANING_INTERVAL=3600
CLEAN_STORE_MESSAGES=false
CLEAN_STORE_MESSAGE_UP=false
CLEAN_STORE_CONTACTS=false
CLEAN_STORE_CHATS=false

# Legacy Database Fallback
# Set to 'false' to disable the legacy database fallback and suppress permission errors in logs.
# LEGACY_FALLBACK_ENABLED=true

# =============================================================================
# FEATURE FLAGS & BUSINESS LOGIC
# =============================================================================

# Upsell System
UPSELL_ENABLED=on
UPSELL_MAX_PER_CONVERSATION=1
UPSELL_TIMEOUT_MS=300000

# Automated Messaging System
REMINDER_ENABLED=on
PRE_VISIT_ENABLED=true
PRE_VISIT_WINDOW_HOURS=24
PRE_VISIT_WINDOW_MAX_HOURS=40

# No-Show Shield
NO_SHOW_SHIELD_ENABLED=on
NO_SHOW_CHECK_HOUR=18
NO_SHOW_CHECK_DAYS_BEFORE=1

# Message Scheduler Worker
SCHEDULER_ENABLED=true
WORKER_POLL_INTERVAL_MS=5000
WORKER_BATCH_SIZE=50
SCHEDULER_MAX_RETRIES=3
SCHEDULER_RETRY_BACKOFF_MS=300000

# Opt-out System
OPT_OUT_ENABLED=true
OPT_OUT_KEYWORDS=PARAR,STOP,SAIR,CANCELAR
OPT_IN_KEYWORDS=VOLTAR,ATIVAR,SIM,QUERO

# =============================================================================
# PRIVACY & SECURITY
# =============================================================================

# PII Protection
MASK_PII_IN_LOGS=true
LOG_RETENTION_DAYS=30

# Rate Limiting
WEBHOOK_RATE_LIMIT_PER_MINUTE=300
ADMIN_RATE_LIMIT_PER_MINUTE=100

# Webhook Security
WEBHOOK_DEDUPE_WINDOW_MS=300000
WEBHOOK_DEDUPE_MAX_CACHE_SIZE=10000

# =============================================================================
# PERFORMANCE & MONITORING
# =============================================================================

# Performance Testing
PERF_TARGET_JOBS_PER_MINUTE=60
PERF_MAX_LATENCY_MS=100
PERF_CONCURRENT_CONVERSATIONS=10